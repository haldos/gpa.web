<h1 class="title">Fan Chirp Transform for Music Representation</h1>


<h2 class="title">Description</h2>
<p> Here you can find some information and the Matlab/Octave source code for the computation of the Fan Chirp Transform and a F0gram based on it,  
 proposed in the article
<a href="http://iie.fing.edu.uy/publicaciones/2010/CLR10/">"FAN CHIRP TRANSFORM FOR MUSIC REPRESENTATION"</a>, P. Cancela, E. Lopez, M. Rocamora, 
DAFx 2010. </p>
<br>

<p>The Fan Chirp Transform (FChT) provides an acute representation of harmonically related linear chirp signals. The FChT can be considered as a time warping followed by a Fourier Transform, which enables an efficient implementation based on the FFT.</p> 
<br>
<p>The FChT was introduced in the work by L. Weruaga and M. Kepesi (e.g. <a href="http://dx.doi.org/10.1016/j.sigpro.2007.01.006">reference</a>). Our formulation and implementation of the FChT was devised independently from the original work so its properties are slightly different.  The goal of the formulation is to obtain a more acute representation of linear chirps. A positive byproduct is that it also enables the application of arbitrary warpings in order to analyze non-linear chirps straightforwardly. In addition, the implementation is designed with an emphasis on computational cost.</p> 
<br>

<p>In this work the FChT is applied to the analysis of pitch content in polyphonic music. A F0gram is computed based on gathering harmonically related peaks of the FChT. Besides, it is combined with the CQT to provide time-frequency multi-resolution in the fan geometry.</p> 
<br>

<h2 class="title">Implementation</h2>
<p>The source code is available <a href="./src/fcht/FanChirpF0gram_v1.zip">here</a> (Matlab/Octave and some C code functions).</p>
<br>

<p>
This code computes a Short Time FChT. 
A F0gram is also computed based on the FChT and a set of f0  
candidates is returned for each audio frame.

The F0gram code, as provided, is intended for main melody extraction.
For this reason a f0 preference function is applied (but can be disabled).

The code also enables the usage of a combination of the FChT and the  
Constant Q-Transform.</p>
<p> For a detailed description of the implementation please refer to the article.</p>
<br>

<h2 class="title">Examples</h2>

<p>The following examples show the time-frequency representation obtained with the FChT as well as the pitch content visualization provided by the F0gram. 
 <UL>
  <LI><A href="./audio/example1-fcht.wav">Example 1 (audio)</A> <br> 
This is an audio excerpt (which is used throughout the article) of the music file "pop1.wav" from the MIREX melody extraction test set. It consist of three simultaneous prominent singing voices in the first part followed by a single voice in the second part, and a rather soft accompaniment whithout percussion.<br><br>
  <LI><A href="./audio/example2-fcht.wav">Example 2 (audio)</A> <br> 
This is an audio excerpt of the music file "opera_fem4.wav" from the MIREX melody extraction test set. It is a short fragment of an opera passage performed by a female voice and orchestra. The singing voice exhibits rapid pitch fluctuations.  
 </UL>
<center>
<A href="./images/t-f_representations.png"><img alt="t-f_representations" src="./images/t-f_representations_preview.png" border=0></A>
<center>
<small>
Example 1: left, example 2: right (click to enlarge)<br>
Comparison of spectrogram (above) and Short Time FChT (below).
Note the improved <br> time-frequency resolution for the most prominent singing voice in the latter representation.
</small>
<br><br>
<br>
<center>
<A href="./images/f0gram_visualization_example1.png"><img alt="f0gram_example1" src="./images/f0gram_visualization_example1_preview.png" border=0></A>
<center>
<small>
Example 1 - melodic content visualization (click to enlarge)<br>
The pitch contour of the three simultaneous singing voices followed by a single voice can be <br>clearly appreciated. 
Note that the 2nd submultiple is noticeable as it has not been attenuated.
</small>
<br><br>
<br>
<center>
<A href="./images/f0gram_visualization_example2.png"><img alt="f0gram_example2" src="./images/f0gram_visualization_example2_preview.png" border=0></A>
<center>
<small>
Example 2 - melodic content visualization (click to enlarge)<br>
The pitch contour of the singing voice is clearly appreciated.<br> 
Note that the 2nd and 3rd submultiples have not been attenuated.
</small>
</p>
